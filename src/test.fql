Let([{"ref": Ref(Collection("User"), "370694906009616457")}, {"document": Get(Ref(Collection("User"), "370694906009616457"))}], Merge({"id": Select(["ref", "id"], Var("document")), "ts": Select(["ts"], Var("document")), "email": Select(["data", "email"], Var("document"), null), "name": Select(["data", "name"], Var("document"), null), "password": Select(["data", "password"], Var("document"), null), "jobs": Select("data", Map(Paginate(Match(Index("jobs_by_jobs"), [Var("ref")])), Lambda("values", Let([{"ref": Select(Subtract(Count(Var("values")), 1), Var("values"))}], Let([{"ref": Var("ref")}, {"document": Get(Var("ref"))}], Merge({"id": Select(["ref", "id"], Var("document")), "ts": Select(["ts"], Var("document")), "title": Select(["data", "title"], Var("document"), null), "owner": Let([{"ref": Select(["data", "owner"], Var("document"))}, {"document": Get(Select(["data", "owner"], Var("document")))}], Merge({"id": Select(["ref", "id"], Var("document")), "ts": Select(["ts"], Var("document")), "email": Select(["data", "email"], Var("document"), null), "name": Select(["data", "name"], Var("document"), null), "password": Select(["data", "password"], Var("document"), null)}, {"id": ["ref", "id"], "ts": ["ts"], "email": ["data", "email"], "name": ["data", "name"], "password": ["data", "password"]}, Lambda(["key", "a", "b"], If(ContainsPath(Var("b"), Var("document")), Var("a"), null))))}, {"id": ["ref", "id"], "ts": ["ts"], "title": ["data", "title"], "owner": ["data", "owner"]}, Lambda(["key", "a", "b"], If(ContainsPath(Var("b"), Var("document")), Var("a"), null))))))))}, {"id": ["ref", "id"], "ts": ["ts"], "email": ["data", "email"], "name": ["data", "name"], "password": ["data", "password"], "jobs": ["data", "jobs"]}, Lambda(["key", "a", "b"], If(ContainsPath(Var("b"), Var("document")), Var("a"), null))))